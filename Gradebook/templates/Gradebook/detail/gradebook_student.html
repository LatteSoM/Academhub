{% extends 'base_detail.html' %}



{% load django_tables2 %}
{% load util %}

{% block detail-header %}
<h1>
    Ведомость {{object}}
</h1>
{% endblock %}

{% block actions-button %}
    {% if fieldset.is_admin == "true" %}
        <a class="btn-primary" href="{% url url_update pk=object.pk %}">
        Изменить
        </a>
        {% if object.status == "Не заполнена" %}
            <a href="{% url 'check_open_gradebook' pk=object.pk %}" class="btn btn-primary">Открыть ведомость</a>
        {% endif %}
        {% if object.status == "Заполнена" %}
            <a href="{% url 'download_report' pk=object.pk %}" class="btn btn-primary">Закрыть ведомость</a>
        {% endif %}
    {% else %}

    {% endif %}

{% endblock %}

{% block ditail-content %}

    {{ block.super }}
    
    <div class="detail-content" style="margin-top: 20px;">
        <div class="detail-tabs">
            <button class="detail-tab active tab-button" data-tab="info">Квалификации</button>
        </div>
        
        <div class="detail-tab-content">
            <a class="btn-primary" href="{% url 'gradebookstudents_bulk_create' pk=object.pk %}">
                Заполнить ведомость
            </a>
            {% with table=tables.0 %}
                {% render_table table 'inc/table/table.html' %}
                {% include 'inc/pagination.html' with page_obj=table.page %}
            {% endwith %}
        </div>
    </div>

    <div class="detail-content" style="margin-top: 20px;">
        <div class="detail-tabs">
            <button class="detail-tab active tab-button" data-tab="info">Преподаватели</button>
        </div>
        
        <div class="detail-tab-content">
            {% with table=tables.1 %}
                {% render_table table 'inc/table/table.html' %}
                {% include 'inc/pagination.html' with page_obj=table.page %}
            {% endwith %}
        </div>
    </div>


    <!-- Добавьте этот код в ваш базовый шаблон (например, base.html) -->
<style>
/* Стили для уведомлений */
.notification-wrapper {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 99999; /* Максимальный приоритет поверх всех элементов */
    max-width: 400px;
}

.notification {
    padding: 15px 35px 15px 15px;
    margin-bottom: 10px;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    opacity: 0;
    transform: translateY(-20px);
    animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    font-family: Arial, sans-serif;
    font-size: 14px;
    display: flex;
    align-items: center;
    min-width: 300px;
}

@keyframes slideIn {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.alert-success {
    background: #d4edda;
    color: #155724;
    border: 2px solid #c3e6cb;
}

.alert-error {
    background: #f8d7da;
    color: #721c24;
    border: 2px solid #f5c6cb;
}

.close-btn {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 20px;
    line-height: 1;
    color: inherit;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.close-btn:hover {
    opacity: 1;
}

/* Анимация исчезновения */
.notification.hide {
    animation: slideOut 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes slideOut {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(-20px);
    }
}
</style>
{% block messages %}
<!-- HTML для отображения уведомлений -->
{% if messages %}
<div class="notification-wrapper">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} notification">
        <span class="close-btn" onclick="this.parentElement.classList.add('hide')">&times;</span>
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Автоматическое скрытие уведомлений через 7 секунд
    const notifications = document.querySelectorAll('.notification');

    notifications.forEach(notification => {
        // Запуск анимации исчезновения через 7 секунд
        setTimeout(() => {
            notification.classList.add('hide');
            // Полное удаление из DOM после анимации
            setTimeout(() => notification.remove(), 500);
        }, 7000);

        // Закрытие по клику
        notification.querySelector('.close-btn').addEventListener('click', () => {
            notification.classList.add('hide');
            setTimeout(() => notification.remove(), 500);
        });
    });
});
</script>
{% endblock %}
{% endblock %}

